@@ -1,11 +1,12 @@
-module adj_sample_eos_pressure_kernel_mod
+module atl_sample_eos_pressure_kernel_mod
   use argument_mod, only : arg_type, cell_column, func_type, gh_basis, gh_evaluator, gh_field, gh_read, gh_readwrite, gh_real, &
 &gh_write
   use constants_mod, only : i_def, r_def
   use fs_continuity_mod, only : w3, wtheta
   use kernel_mod, only : kernel_type
+  use planet_config_mod, only : kappa, rd, p_zero
   implicit none
-  type, public, extends(kernel_type) :: adj_sample_eos_pressure_kernel_type
+  type, public, extends(kernel_type) :: atl_sample_eos_pressure_kernel_type
   type(ARG_TYPE) :: META_ARGS(7) = (/ &
     arg_type(gh_field, gh_real, gh_readwrite, w3), &
     arg_type(gh_field, gh_real, gh_readwrite, w3), &
@@ -20,16 +21,16 @@
   INTEGER :: GH_SHAPE = gh_evaluator
   INTEGER :: OPERATES_ON = cell_column
   CONTAINS
-    PROCEDURE, NOPASS :: adj_sample_eos_pressure_code
-END TYPE adj_sample_eos_pressure_kernel_type
+    PROCEDURE, NOPASS :: atl_sample_eos_pressure_code
+END TYPE atl_sample_eos_pressure_kernel_type
 
   private
 
-  public :: adj_sample_eos_pressure_code
+  public :: atl_sample_eos_pressure_code
 
   contains
-  subroutine adj_sample_eos_pressure_code(nlayers, exner, rho, theta, moist_dyn_gas, ls_rho, ls_theta, ls_moist_dyn_gas, ndf_w3, &
-&undf_w3, map_w3, w3_basis, ndf_wt, undf_wt, map_wt, wt_basis)
+  subroutine atl_sample_eos_pressure_code(nlayers, exner, rho, theta, moist_dyn_gas, ls_rho, ls_theta, ls_moist_dyn_gas, ndf_w3, &
+&undf_w3, map_w3, w3_basis, basis_w3_on_wt, ndf_wt, undf_wt, map_wt, wt_basis, basis_wt_on_wt)
     use coordinate_jacobian_mod, only : coordinate_jacobian
     integer(kind=i_def), intent(in) :: nlayers
     integer(kind=i_def), intent(in) :: ndf_wt
@@ -39,7 +40,9 @@
     integer(kind=i_def), dimension(ndf_wt), intent(in) :: map_wt
     integer(kind=i_def), dimension(ndf_w3), intent(in) :: map_w3
     real(kind=r_def), dimension(1,ndf_w3,ndf_w3), intent(in) :: w3_basis
+    real(kind=r_def), dimension(1,ndf_w3,ndf_wt), intent(in) :: basis_w3_on_wt
     real(kind=r_def), dimension(1,ndf_wt,ndf_w3), intent(in) :: wt_basis
+    real(kind=r_def), dimension(1,ndf_wt,ndf_wt), intent(in) :: basis_wt_on_wt
     real(kind=r_def), dimension(undf_w3), intent(inout) :: exner
     real(kind=r_def), dimension(undf_w3), intent(inout) :: rho
     real(kind=r_def), dimension(undf_wt), intent(inout) :: theta
@@ -59,9 +62,6 @@
     real(kind=r_def) :: theta_vd_cell
     real(kind=r_def) :: ls_rho_cell
     real(kind=r_def) :: ls_theta_vd_cell
-    real(kind=r_def) :: kappa
-    real(kind=r_def) :: rd
-    real(kind=r_def) :: p_zero
     real(kind=r_def) :: tmp_ls_exner
     real(kind=r_def) :: tmp_exner
 
@@ -112,6 +112,6 @@
       enddo
     enddo
 
-  end subroutine adj_sample_eos_pressure_code
+  end subroutine atl_sample_eos_pressure_code
 
-end module adj_sample_eos_pressure_kernel_mod
+end module atl_sample_eos_pressure_kernel_mod
